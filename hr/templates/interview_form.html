{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<div class="card m-4 p-4">
    <div class="card-header">
        {% if interview_form.instance.pk %}
            <h2>Update Interview</h2>
        {% else %}
            <h2>Add Interview</h2>
        {% endif %}
    </div>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <fieldset>
            <div class="row">
                <div class="col-md-5 ">
                    <div class="">
                        <h5>Image</h5>
                        <div id="imagePreview" class="border p-2 mb-3" style="height: 200px; width: 200px; background-size: cover; background-position: center;">
                            <!-- Image preview will be shown here -->
                        </div>
                        
                    {{ interview_form.user_image|as_crispy_field }}

                </div>
                </div>
                <div class="col-md-7 p-2">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            {{ interview_form.interview_no|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-3">
                            {{ interview_form.interview_date|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-3">
                            {{ interview_form.reference|as_crispy_field }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            {{ interview_form.first_name|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-3">
                            {{ interview_form.middle_name|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-3">
                            {{ interview_form.last_name|as_crispy_field }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            {{ interview_form.gender|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-3">
                            {{ interview_form.father_name|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-3">
                            {{ interview_form.mother_name|as_crispy_field }}
                        </div>
                    </div>
                </div>  
                <div class="row">
                    <div class="col-md-3">
                        {{ interview_form.date_of_birth|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ interview_form.category|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ interview_form.current_salary|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{ interview_form.expected_salary|as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{interview_form.department | as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{interview_form.marital_status | as_crispy_field }}
                    </div>
                    <div class="col-md-3">
                        {{interview_form.designation | as_crispy_field }}
                    </div>
                </div>
            </div>
        </fieldset>
        
        <hr>

        <fieldset>
            <legend>Contact Information</legend>
            <div class = "row">
                <div class="col-md-3">
                    {{ interview_form.current_address|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.city|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.state|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.pin|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.mobile|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.mobile2|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.email|as_crispy_field }}
                </div>
            </div>
        </fieldset>
        
        <hr>

        <fieldset>
            <legend>Previous Company Details</legend>
            <div class = "row">
                <div class="col-md-3">
                    {{ interview_form.company_name|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.prev_comp_hr_no|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.work_profile|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.joining_date|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.leaving_date|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.leaving_reason|as_crispy_field }}
                </div>
                <div class="col-md-3">
                    {{ interview_form.salary|as_crispy_field }}
                </div>
            </div>
        </fieldset>        
        
        <hr>

        <fieldset>
            <legend>Feedback</legend>
            <div class = "row">
                <div class="col-md-4">
                    {{ interview_form.recommendation_positive|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.recommendation_negative|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.rating|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.select_for_next_round|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.assign|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.date|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.status|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.overall_comment|as_crispy_field }}
                </div>
                <div class="col-md-4">
                    {{ interview_form.remark|as_crispy_field }}
                </div>
            </div>
        </fieldset>  

        <div class="row mt-3">
            <div class="col-md-12">
                <a href="{% url 'hr:list_of_interview' %}" class="btn btn-secondary">Back to List</a>
                <button type="submit" class="btn btn-primary">Save</button>
            </div>
        </div>
    </form>
</div>
{% comment %} 
this script should be placed here instead of placing it in base.html file
    Beacuse It conflicts with dependent dropdown in the home page 
    
    if this script is placed in the base.html file the side menu will be dissappear{% endcomment %}

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const imageInput = document.querySelector('#id_user_image');
            const imagePreview = document.querySelector('#imagePreview');
        
            imageInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        imagePreview.style.backgroundImage = `url('${e.target.result}')`;
                    }
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>

{% endblock content %}